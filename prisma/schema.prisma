// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Usuario {
  cpf Int @id
  nome String
  email String
  pass String
  cel Int
  isCliente Boolean
  isTecnico Boolean
}

model Cliente {
cpfCliente Int @id
valorConfirmacao Int

// Relations
pedidos Pedido[]
avaliacoes Avaliacao[]
chats Chat[]
trabalhos Trabalho[]
ratings Rating[]
}

model Tecnico {
cpfTecnico Int @id

// Relations
avaliacoes Avaliacao[]
pedidos Pedido[]
chats Chat[]
trabalhos Trabalho[]
ratings Rating[]
}

model Avaliacao {
idAvaliacao Int @id @default(autoincrement())
rateCliente Int
cpfTecnico Int?
cpfCliente Int?

// Relations
tecnico Tecnico? @relation(fields: [cpfTecnico], references: [cpfTecnico])
client Cliente?  @relation(fields: [cpfCliente], references: [cpfCliente])
}

model Pedido {
idPedido Int @id @default(autoincrement())
image String?
descPedido String
orcamentoPedido Decimal
horarioInicioPedido DateTime @default(now())
cpfTecnico Int?
cpfCliente Int
horarioPedido DateTime
statusPedido Boolean

// Relations
tecnico Tecnico? @relation(fields: [cpfTecnico], references: [cpfTecnico])
cliente Cliente @relation(fields: [cpfCliente], references: [cpfCliente])
trabalhos Trabalho[]
}

model Chat {
idChat Int @id @default(autoincrement())
cpfTecnico Int?
cpfCliente Int
statusChat Boolean
horarioInicioChat DateTime @default(now())

// Relations
tecnico Tecnico? @relation(fields: [cpfTecnico], references: [cpfTecnico])
cliente Cliente @relation(fields: [cpfCliente], references: [cpfCliente])
mensagens Mensagem[]
}

model Mensagem {
idMensagem Int @id @default(autoincrement())
idSender Int
messageText String
horarioMensagem DateTime @default(now())
idChat Int?

// Relations
chat Chat? @relation(fields: [idChat], references: [idChat])
}

model Rating {
idRating Int @id @default(autoincrement())
rateTecnico Int?
cpfTecnico Int?
cpfCliente Int?

// Relations
tecnico Tecnico? @relation(fields: [cpfTecnico], references: [cpfTecnico])
cliente Cliente? @relation(fields: [cpfCliente], references: [cpfCliente])
}

model Trabalho {
idTrabalho Int @id @default(autoincrement())
cpfTecnico Int?
cpfCliente Int?
idPedido Int?
statusTrabalho Boolean
orcamentoTrabalho Decimal
ratingTrabalho Int
tip Decimal
horarioMensagem DateTime @default(now())
dataFimTrabalho DateTime?

// Relations
tecnico Tecnico? @relation(fields: [cpfTecnico], references: [cpfTecnico])
cliente Cliente? @relation(fields: [cpfCliente], references: [cpfCliente])
pedido Pedido? @relation(fields: [idPedido], references: [idPedido])
}